{"version":3,"sources":["marionette.toolkit.js"],"names":[],"mappings":"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","file":"marionette.toolkit.js","sourcesContent":["/**\n * marionette.toolkit - A collection of opinionated Backbone.Marionette extensions for large scale application architecture.\n * @version v0.4.0\n * @link https://github.com/RoundingWellOS/marionette.toolkit\n * @license MIT\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('backbone.marionette'), require('underscore'), require('backbone')) :\n  typeof define === 'function' && define.amd ? define(['backbone.marionette', 'underscore', 'backbone'], factory) :\n  global.Marionette.Toolkit = factory(global.Marionette, global._, global.Backbone)\n}(this, function (Marionette, _, Backbone) { 'use strict';\n\n  var StateClass = Marionette.Object.extend({\n\n    /**\n     * The model class for _stateModel.\n     * @type {Backbone.Model}\n     * @default Backbone.Model\n     */\n    StateModel: Backbone.Model,\n\n    /**\n     * @public\n     * @constructs StateClass\n     * @param {Object} [options] - Settings for the stateClass.\n     * @param {Object} [options.stateEvents] - Event hash bound from _stateModel to stateClass.\n     * @param {Backbone.Model} [options.StateModel] - Model class for _stateModel.\n     */\n    constructor: function(options){\n      options = options || {};\n\n      // Make defaults available to this\n      _.extend(this, _.pick(options, ['StateModel', 'stateEvents', 'stateDefaults']));\n\n      var StateModel = this._getStateModel(options);\n\n      this._stateModel = new StateModel(_.result(this, 'stateDefaults'));\n\n      // Bind events from the _stateModel defined in stateEvents hash\n      this.bindEntityEvents(this._stateModel, _.result(this, 'stateEvents'));\n\n      Marionette.Object.call(this, options);\n    },\n\n    /**\n     * Get the StateClass StateModel class.\n     * Checks if the `StateModel` is a model class (the common case)\n     * Then check if it's a function (which we assume that returns a model class)\n     *\n     * @private\n     * @method _getStateModel\n     * @param {Object} [options] - Options that can be used to determine the StateModel.\n     * @memberOf StateClass\n     * @returns {Backbone.Model}\n     */\n    _getStateModel: function(options){\n      var StateModel = this.getOption('StateModel');\n\n      if (StateModel.prototype instanceof Backbone.Model || StateModel === Backbone.Model) {\n        return StateModel;\n      } else if (_.isFunction(StateModel)) {\n        return StateModel.call(this, options);\n      } else {\n        throw new Marionette.Error({\n          name: 'InvalidStateModelError',\n          message: '\"StateModel\" must be a model class or a function that returns a model class'\n        });\n      }\n    },\n\n    /**\n     * Set a property on the _stateModel.\n     *\n     * @public\n     * @method setState\n     * @memberOf StateClass\n     * @param {String|Object} key - Attribute name or Hash of any number of key value pairs.\n     * @param {*} [value] - Attribute value if key is String, replaces options param otherwise.\n     * @param {Object} [options] - Backbone.Model options.\n     * @returns {Backbone.Model} - The _stateModel\n     */\n    setState: function(){\n      return this._stateModel.set.apply(this._stateModel, arguments);\n    },\n\n    /**\n     * Get a property from the _stateModel, or return the _stateModel\n     *\n     * @public\n     * @method getState\n     * @memberOf StateClass\n     * @param {String} [attr] - Attribute name of stateModel.\n     * @returns {Backbone.Model|*} - The _stateModel or the attribute value of the _stateModel\n     */\n    getState: function(attr){\n      if(!attr) {\n        return this._stateModel;\n      }\n\n      return this._stateModel.get.apply(this._stateModel, arguments);\n    },\n\n    /**\n     * Destroy the stateClass and clean up any listeners on the _stateModel.\n     *\n     * @public\n     * @method destroy\n     * @memberOf StateClass\n     */\n    destroy: function(){\n      this._stateModel.stopListening();\n\n      Marionette.Object.prototype.destroy.apply(this, arguments);\n    }\n  });\n\n  var state_class = StateClass;\n\n  var AbstractApp = state_class.extend({\n\n    /**\n     * Internal flag indiciate when `App` has started but has not yet stopped.\n     *\n     * @private\n     * @type {Boolean}\n     * @default false\n     */\n    _isRunning: false,\n\n    /**\n     * Internal flag indiciate when `App` has been destroyed\n     *\n     * @private\n     * @type {Boolean}\n     * @default false\n     */\n    _isDestroyed: false,\n\n    /**\n     * Set to true if a parent `App` should not be able to destroy this `App`.\n     *\n     * @type {Boolean|Function}\n     * @default false\n     */\n    preventDestroy: false,\n\n    /**\n     * Set to true if `App` should be started after it is initialized.\n     *\n     * @type {Boolean|Function}\n     * @default false\n     */\n    startAfterInitialized: false,\n\n    /**\n     * Set to true if `App` should be started after its parent starts.\n     *\n     * @type {Boolean|Function}\n     * @default false\n     */\n    startWithParent: false,\n\n    /**\n     * Set to false if `App` should not stop after its parent stops.\n     *\n     * @type {Boolean|Function}\n     * @default true\n     */\n    stopWithParent: true,\n\n    /**\n     * @public\n     * @constructs AbstractApp\n     * @param {Object} [options] - Settings for the App.\n     * @param {Boolean} [options.startWithParent]\n     * @param {Boolean} [options.stopWithParent]\n     * @param {Boolean} [options.startAfterInitialized]\n     * @param {Boolean} [options.preventDestroy]\n     */\n    constructor: function(options) {\n      options = options || {};\n\n      _.bindAll(this, 'start', 'stop');\n\n      var pickOptions = [\n        'startWithParent',\n        'stopWithParent',\n        'startAfterInitialized',\n        'preventDestroy'\n      ];\n\n      _.extend(this, _.pick(options, pickOptions));\n\n      // Will call initialize\n      state_class.call(this, options);\n\n      if(_.result(this, 'startAfterInitialized')) {\n        this.start(options);\n      }\n    },\n\n    /**\n     * Internal helper to verify if `App` has been destroyed\n     *\n     * @private\n     * @method _ensureAppIsIntact\n     * @memberOf AbstractApp\n     * @throws AppDestroyedError - Thrown if `App` has already been destroyed\n     */\n    _ensureAppIsIntact: function() {\n      if(this._isDestroyed) {\n        throw new Marionette.Error({\n          name: 'AppDestroyedError',\n          message: 'App has already been destroyed and cannot be used.'\n        });\n      }\n    },\n\n    /**\n     * Gets the value of internal `_isRunning` flag\n     *\n     * @public\n     * @method isRunning\n     * @memberOf AbstractApp\n     * @returns {Boolean}\n     */\n    isRunning: function() {\n      return this._isRunning;\n    },\n\n    /**\n     * Sets the app lifecycle to running.\n     *\n     * @public\n     * @method start\n     * @memberOf AbstractApp\n     * @param {Object} [options] - Settings for the App passed through to events\n     * @event AbstractApp#before:start - passes options\n     * @returns {AbstractApp}\n     */\n    start: function(options) {\n      this._ensureAppIsIntact();\n\n      if(this._isRunning) {\n        return this;\n      }\n\n      this.triggerMethod('before:start', options);\n\n      this._isRunning = true;\n\n      this.triggerStart(options);\n\n      return this;\n    },\n\n    /**\n     * Triggers start event.\n     * Override to introduce async start\n     *\n     * @public\n     * @method triggerStart\n     * @memberOf AbstractApp\n     * @param {Object} [options] - Settings for the App passed through to events\n     * @event AbstractApp#start - passes options\n     * @returns\n     */\n    triggerStart: function(options) {\n      this.triggerMethod('start', options);\n    },\n\n    /**\n     * Sets the app lifecycle to not running.\n     * Removes any listeners added during the running state\n     *\n     * @public\n     * @method stop\n     * @memberOf AbstractApp\n     * @param {Object} [options] - Settings for the App passed through to events\n     * @event AbstractApp#before:stop - passes options\n     * @event AbstractApp#stop - passes options\n     * @returns {AbstractApp}\n     */\n    stop: function(options) {\n      if(!this._isRunning) {\n        return this;\n      }\n\n      this.triggerMethod('before:stop', options);\n\n      this._isRunning = false;\n\n      this.triggerMethod('stop', options);\n\n      this._stopRunningListeners();\n      this._stopRunningEvents();\n\n      return this;\n    },\n\n    /**\n     * Gets the value of internal `_isDestroyed` flag\n     *\n     * @public\n     * @method isDestroyed\n     * @memberOf AbstractApp\n     * @returns {Boolean}\n     */\n    isDestroyed: function() {\n      return this._isDestroyed;\n    },\n\n    /**\n     * Stops the `App` and sets it destroyed.\n     *\n     * @public\n     * @method destroy\n     * @memberOf AbstractApp\n     */\n    destroy: function() {\n      if(this._isDestroyed) {\n        return;\n      }\n\n      this._isDestroyed = true;\n\n      this.stop();\n\n      state_class.prototype.destroy.apply(this, arguments);\n    },\n\n    /**\n     * Internal method to stop any registered events.\n     *\n     * @private\n     * @method _stopRunningEvents\n     * @memberOf AbstractApp\n     */\n    _stopRunningEvents: function(){\n      _.each(this._runningEvents, function(args) {\n        this.off.apply(this, args);\n      }, this);\n    },\n\n    /**\n     * Internal method to stop any registered listeners.\n     *\n     * @private\n     * @method _stopRunningListeners\n     * @memberOf AbstractApp\n     */\n    _stopRunningListeners: function(){\n      _.each(this._runningListeningTo, function(args) {\n        this.stopListening.apply(this, args);\n      }, this);\n    },\n\n    /**\n     * Overrides `Backbone.Event.on()`\n     * If this `App` is running it will register the event for removal `onStop`\n     *\n     * @public\n     * @method on\n     * @memberOf AbstractApp\n     * @returns {AbstractApp}\n     */\n    on: function() {\n      if(this._isRunning) {\n        this._runningEvents = (this._runningEvents || []);\n        this._runningEvents.push(arguments);\n      }\n      return state_class.prototype.on.apply(this, arguments);\n    },\n\n    /**\n     * Overrides `Backbone.Event.listenTo()`\n     * If this `App` is running it will register the listener for removal `onStop`\n     *\n     * @public\n     * @method listenTo\n     * @memberOf AbstractApp\n     * @returns {AbstractApp}\n     */\n    listenTo: function() {\n      if(this._isRunning) {\n        this._runningListeningTo = (this._runningListeningTo || []);\n        this._runningListeningTo.push(arguments);\n      }\n      return state_class.prototype.listenTo.apply(this, arguments);\n    },\n\n    /**\n     * Overrides `Backbone.Event.listenToOnce()`\n     * If this `App` is running it will register the listener for removal `onStop`\n     *\n     * @public\n     * @method listenToOnce\n     * @memberOf AbstractApp\n     * @returns {AbstractApp}\n     */\n    listenToOnce: function(){\n      if(this._isRunning) {\n        this._runningListeningTo = (this._runningListeningTo || []);\n        this._runningListeningTo.push(arguments);\n      }\n\n      return state_class.prototype.listenToOnce.apply(this, arguments);\n    }\n  });\n\n  var abstract_app = AbstractApp;\n\n  var App = abstract_app.extend({\n\n    /**\n     * @public\n     * @constructs App\n     * @param {Object} [options] - Settings for the App.\n     * @param {Object} [options.childApps] - Hash for setting up child apps.\n     *\n     * ```js\n     * childApps: {\n     *   appName: {\n     *     AppClass: MyChildAppClass,\n     *     fooOption: true,\n     *     startWithParent: true\n     *   },\n     *   barApp: MyOtherChildAppClass\n     * }\n     * ```\n     */\n    constructor: function(options) {\n      options = options || {};\n\n      this._childApps = {};\n\n      _.extend(this, _.pick(options, ['childApps']));\n\n      this._initChildApps(options);\n\n      // The child apps should be handled while the app is running;\n      // After start, before stop, and before destroy.\n      this.on({\n        'start'          : this._startChildApps,\n        'before:stop'    : this._stopChildApps,\n        'before:destroy' : this._destroyChildApps\n      });\n\n      abstract_app.call(this, options);\n    },\n\n    /**\n     * Initializes `childApps` option\n     *\n     * @private\n     * @method _initChildApps\n     * @memberOf App\n     */\n    _initChildApps: function(options) {\n      var childApps = this.childApps;\n\n      if(childApps) {\n\n        if(_.isFunction(childApps)) {\n          childApps = childApps.call(this, options);\n        }\n\n        this.addChildApps(childApps);\n      }\n    },\n\n    /**\n     * Starts `childApps` if allowed by child\n     *\n     * @private\n     * @method _startChildApps\n     * @memberOf App\n     */\n    _startChildApps: function() {\n      _.each(this._childApps, function(childApp) {\n        if(_.result(childApp, 'startWithParent')) {\n          childApp.start();\n        }\n      });\n    },\n\n    /**\n     * Stops `childApps` if allowed by child\n     *\n     * @private\n     * @method _stopChildApps\n     * @memberOf App\n     */\n    _stopChildApps: function() {\n      _.each(this._childApps, function(childApp) {\n        if(_.result(childApp, 'stopWithParent')) {\n          childApp.stop();\n        }\n      });\n    },\n\n    /**\n     * Destroys `childApps` if allowed by child\n     *\n     * @private\n     * @method _destroyChildApps\n     * @memberOf App\n     */\n    _destroyChildApps: function() {\n      _.each(this._childApps, function(childApp) {\n        if(!_.result(childApp, 'preventDestroy')) {\n          childApp.destroy();\n        }\n      });\n    },\n\n    /**\n     * Internal helper to instantiate and `App` from on `Object`\n     *\n     * @private\n     * @method _buildAppFromObject\n     * @memberOf App\n     * @param {Object} appConfig - `AppClass` and any other option for the `App`\n     * @returns {App}\n     */\n    _buildAppFromObject: function(appConfig) {\n      var AppClass = appConfig.AppClass;\n      var options = _.omit(appConfig, 'AppClass');\n\n      return this.buildApp(AppClass, options);\n    },\n\n    /**\n     * Helper for building an App and return it\n     *\n     * @private\n     * @method _buildApp\n     * @memberOf App\n     * @param {App} AppClass - An App Class\n     * @param {Object} AppClass - Optionally passed as an appConfig Object\n     * @param {Object} [options] - options for the AppClass\n     * @returns {App}\n     */\n    _buildApp: function(AppClass, options) {\n      if(_.isFunction(AppClass)) {\n        return this.buildApp(AppClass, options);\n      }\n      if(_.isObject(AppClass)) {\n        return this._buildAppFromObject(AppClass);\n      }\n    },\n\n    /**\n     * Build an App and return it\n     * Override for dynamic App building\n     *\n     * @public\n     * @method buildApp\n     * @memberOf App\n     * @param {App} [AppClass] - An App Class\n     * @param {Object} [options] - options for the AppClass\n     * @returns {App}\n     */\n    buildApp: function(AppClass, options) {\n      return new AppClass(options);\n    },\n\n    /**\n     * Internal helper to verify `appName` is unique and not in use\n     *\n     * @private\n     * @method _ensureAppIsUnique\n     * @memberOf App\n     * @param {String} appName - Name of app to test\n     * @throws DuplicateChildAppError - Thrown if `App` already has an `appName` registered\n     */\n    _ensureAppIsUnique: function(appName) {\n      if(this._childApps[appName]) {\n        throw new Marionette.Error({\n          name: 'DuplicateChildAppError',\n          message: 'A child App with name \"' + appName + '\" has already been added.'\n        });\n      }\n    },\n\n    /**\n     * Add child `App`s to this `App`\n     *\n     * @public\n     * @method addChildApps\n     * @memberOf App\n     * @param {Object} childApps - Hash of names and `AppClass` or `appConfig`\n     */\n    addChildApps: function(childApps) {\n      _.each(childApps, function(childApp, appName) {\n        this.addChildApp(appName, childApp);\n      }, this);\n    },\n\n    /**\n     * Build's childApp and registers it with this App\n     * Starts the childApp, if this app is running and child is `startWithParent`\n     *\n     * @public\n     * @method addChildApp\n     * @memberOf App\n     * @param {String} appName - Name of App to register\n     * @param {App} AppClass - An App Class\n     * @param {Object} AppClass - Optionally passed as an appConfig Object\n     * @param {Object} [options] - options for the AppClass\n     * @throws AddChildAppError - Thrown if no childApp could be built from params\n     * @returns {App}\n     */\n    addChildApp: function(appName, AppClass, options) {\n      this._ensureAppIsUnique(appName);\n\n      var childApp = this._buildApp(AppClass, options);\n\n      if(!childApp){\n        throw new Marionette.Error({\n          name: 'AddChildAppError',\n          message: 'App build failed.  Incorrect configuration.'\n        });\n      }\n\n      childApp._name = appName;\n\n      this._childApps[appName] = childApp;\n\n      // When the app is destroyed remove the cached app.\n      childApp.on('destroy', _.partial(this._removeChildApp, appName), this);\n\n      if(this.isRunning() && _.result(childApp, 'startWithParent')) {\n        childApp.start();\n      }\n\n      return childApp;\n    },\n\n    /**\n     * Returns registered child `App`s name\n     *\n     * @public\n     * @method getName\n     * @memberOf App\n     * @returns {String}\n     */\n    getName: function() {\n      return this._name;\n    },\n\n\n    /**\n     * Returns registered child `App`s array\n     *\n     * @public\n     * @method getChildApps\n     * @memberOf App\n     * @returns {Array}\n     */\n    getChildApps: function(){\n      return _.clone(this._childApps);\n    },\n\n    /**\n     * Returns registered child `App`\n     *\n     * @public\n     * @method getChildApp\n     * @memberOf App\n     * @param {String} appName - Name of App to retrieve\n     * @returns {App}\n     */\n    getChildApp: function(appName) {\n      return this._childApps[appName];\n    },\n\n    /**\n     * Internal helper.  Unregisters child `App`\n     *\n     * @private\n     * @method _removeChildApp\n     * @memberOf App\n     * @param {String} appName - Name of App to unregister\n     * @returns {App}\n     */\n    _removeChildApp: function(appName) {\n      delete this._childApps[appName]._name;\n      delete this._childApps[appName];\n    },\n\n    /**\n     * Removes all childApps and returns them.\n     * The return is useful if any app is using `preventDestroy`\n     *\n     * @public\n     * @method removeChildApps\n     * @memberOf App\n     * @returns {Array}\n     */\n    removeChildApps: function(){\n      var childApps = this.getChildApps();\n\n      _.each(this._childApps, function(childApp, appName) {\n        this.removeChildApp(appName);\n      }, this);\n\n      return childApps;\n    },\n\n    /**\n     * Destroys or removes registered child `App` by name\n     * depending on `preventDestroy`\n     *\n     * @public\n     * @method removeChildApp\n     * @memberOf App\n     * @param {String} appName - Name of App to destroy\n     * @param {Object} [options.preventDestroy] - Flag to remove but prevent App destroy\n     * @returns {App}\n     */\n    removeChildApp: function(appName, options) {\n      options = options || {};\n\n      var childApp = this.getChildApp(appName);\n\n      if(!childApp) {\n        return;\n      }\n\n      // if preventDestroy simply unregister the child app\n      if(options.preventDestroy || _.result(childApp, 'preventDestroy')) {\n        this._removeChildApp(appName);\n      } else {\n        childApp.destroy();\n      }\n\n      return childApp;\n    }\n\n  });\n\n  var app = App;\n\n  var Component = state_class.extend({\n\n    /**\n     * The view class to be managed.\n     * @type {Mn.ItemView|Mn.CollectionView|Mn.CompositeView|Mn.LayoutView}\n     * @default Marionette.ItemView\n     */\n    ViewClass: Marionette.ItemView,\n\n    /**\n     * Used as the prefix for events forwarded from\n     * the component's view to the component\n     * @type {String}\n     * @default 'view'\n     */\n    viewEventPrefix: 'view',\n\n    /**\n     * Options hash passed to the view when built.\n     * @type {Object|Function}\n     * @default '{}'\n     */\n    viewOptions: {},\n\n    /**\n     * @public\n     * @constructs Component\n     * @param {Object} [stateAttrs] - Attributes to set on the state model.\n     * @param {Object} [options] - Settings for the component.\n     * @param {Mn.ItemView|Mn.CollectionView|Mn.CompositeView|Mn.LayoutView=} [options.ViewClass]\n     * - The view class to be managed.\n     * @param {String} [options.viewEventPrefix]\n     * - Used as the prefix for events forwarded from the component's view to the component\n     * @param {Object} [options.viewOptions] - Options hash passed to an instantiated ViewClass.\n     * @param {Marionette.Region} [options.region] - The region to show the component in.\n     */\n    constructor: function(stateAttrs, options){\n      options = options || {};\n\n      // Make defaults available to this\n      _.extend(this, _.pick(options, ['viewEventPrefix', 'ViewClass', 'viewOptions', 'region']));\n\n      state_class.call(this, options);\n\n      this._setStateDefaults(stateAttrs);\n    },\n\n    /**\n     * Internal flag to determine if the component should destroy.\n     * Set to false while showing the component's view in the component's region.\n     *\n     * @private\n     * @type {Boolean}\n     * @default true\n     */\n    _shouldDestroy: true,\n\n    /**\n     * Set the state model attributes to the initial\n     * passed in attributes or any defaults set\n     *\n     * @private\n     * @method _setStateDefaults\n     * @memberOf Component\n     * @param {Object} [stateAttrs] - Attributes to set on the state model\n     */\n    _setStateDefaults: function(stateAttrs){\n      this.setState(stateAttrs, { silent: true });\n    },\n\n    /**\n     * Set the Component's region and then show it.\n     *\n     * @public\n     * @method showIn\n     * @memberOf Component\n     * @param {Marionette.Region} region - The region for the component\n     * @param {Object} [viewOptions] - Options hash mixed into the instantiated ViewClass.\n     * @returns {Component}\n     */\n    showIn: function(region, viewOptions) {\n      this.region = region;\n\n      this.show(viewOptions);\n\n      return this;\n    },\n\n    /**\n     * Show the Component in its region.\n     *\n     * @public\n     * @event Component#before:show\n     * @event Component#show\n     * @throws ComponentShowError - Thrown if component has already been show.\n     * @throws ComponentRegionError - Thrown if component has no defined region.\n     * @method show\n     * @param {Object} [viewOptions] - Options hash mixed into the instantiated ViewClass.\n     * @memberOf Component\n     * @returns {Component}\n     */\n    show: function(viewOptions){\n      if(this._isShown) {\n        throw new Marionette.Error({\n          name: 'ComponentShowError',\n          message: 'Component has already been shown in a region.'\n        });\n      }\n\n      if(!this.region) {\n        throw new Marionette.Error({\n          name: 'ComponentRegionError',\n          message: 'Component has no defined region.'\n        });\n      }\n\n      this.triggerMethod('before:show');\n\n      this.renderView(viewOptions);\n      this._isShown = true;\n\n      this.triggerMethod('show');\n\n      // Destroy the component if the region is emptied because\n      // it destroys the view\n      this.listenTo(this.region, 'empty', this._destroy);\n\n      return this;\n    },\n\n    /**\n     * Get the Component ViewClass class.\n     * Checks if the `ViewClass` is a view class (the common case)\n     * Then check if it's a function (which we assume that returns a view class)\n     *\n     * @private\n     * @method _getViewClass\n     * @memberOf Component\n     * @param {Object} [options] - Options that can be used to determine the ViewClass.\n     * @returns {View}\n     */\n    _getViewClass: function(options) {\n      options = options || {};\n\n      var ViewClass = this.getOption('ViewClass');\n\n      if (ViewClass.prototype instanceof Backbone.View || ViewClass === Backbone.View) {\n        return ViewClass;\n      } else if (_.isFunction(ViewClass)) {\n        return ViewClass.call(this, options);\n      } else {\n        throw new Marionette.Error({\n          name: 'InvalidViewClassError',\n          message: '\"ViewClass\" must be a view class or a function that returns a view class'\n        });\n      }\n    },\n\n    /**\n     * Shows or re-shows a newly built view in the component's region\n     *\n     * @public\n     * @event Component#before:render:view\n     * @event Component#render:view\n     * @method renderView\n     * @memberOf Component\n     * @param {Object} [options] - Options hash mixed into the instantiated ViewClass.\n     * @returns {Component}\n     */\n    renderView: function(options){\n      var ViewClass = this._getViewClass(options);\n\n      var viewOptions = this.mixinOptions(options);\n\n      var view = this.buildView(ViewClass, viewOptions);\n\n      // Attach current built view to component\n      this.currentView = view;\n\n      this._proxyViewEvents(view);\n\n      this.triggerMethod('before:render:view', view);\n\n      // _shouldDestroy is flag that prevents the Component from being\n      // destroyed if the region is emptied by Component itself.\n      this._shouldDestroy = false;\n\n      // Show the view in the region\n      this.region.show(view);\n\n      this._shouldDestroy = true;\n\n      this.triggerMethod('render:view', view);\n\n      return this;\n    },\n\n    /**\n     * Proxies the ViewClass's viewEvents to the Component itself\n     * Similar to CollectionView childEvents\n     * (http://marionettejs.com/docs/v2.3.2/marionette.collectionview.html#collectionviews-childevents)\n     *\n     * @private\n     * @method _proxyViewEvents\n     * @memberOf Component\n     * @param {Mn.ItemView|Mn.CollectionView|Mn.CompositeView|Mn.LayoutView} view -\n     * The instantiated ViewClass.\n     */\n    _proxyViewEvents: function(view){\n      var prefix = this.getOption('viewEventPrefix');\n\n      view.on('all', function() {\n        var args = _.toArray(arguments);\n        var rootEvent = args[0];\n\n        args[0] = prefix + ':' + rootEvent;\n        args.splice(1, 0, view);\n\n        this.triggerMethod.apply(this, args);\n      }, this);\n    },\n\n    /**\n     * Mixin stateModel from StateClass with any other viewOptions\n     *\n     * @public\n     * @abstract\n     * @method mixinOptions\n     * @memberOf Component\n     * @param {Object} [options] - Additional options to mixin\n     * @returns {Object}\n     */\n    mixinOptions: function(options){\n      var viewOptions = _.result(this, 'viewOptions');\n\n      return _.extend({ stateModel: this.getState() }, viewOptions, options);\n    },\n\n    /**\n     * Builds the view class with options\n     * If you need a dynamic ViewClass override this function\n     *\n     * @public\n     * @abstract\n     * @method buildView\n     * @memberOf Component\n     * @param {Mn.ItemView|Mn.CollectionView|Mn.CompositeView|Mn.LayoutView} ViewClass -\n     * The view class to instantiate.\n     * @param {Object} [viewOptions] - Options to pass to the View\n     * @returns {Mn.ItemView|Mn.CollectionView|Mn.CompositeView|Mn.LayoutView}\n     */\n    buildView: function(ViewClass, viewOptions) {\n      return new ViewClass(viewOptions);\n    },\n\n    /**\n     * Destroys Component.\n     *\n     * @private\n     * @method _destroy\n     * @memberOf Component\n     */\n    _destroy: function(){\n      if(this._shouldDestroy) {\n        state_class.prototype.destroy.apply(this, arguments);\n      }\n    },\n\n    /**\n     * Empties component's region.\n     *\n     * @private\n     * @method _emptyRegion\n     * @param {Object} [options] - Options passed to `region.empty`\n     * @memberOf Component\n     */\n    _emptyRegion: function(options){\n        if(this.region) {\n          this.stopListening(this.region, 'empty');\n          this.region.empty(options);\n        }\n    },\n\n    /**\n     * Empty the region and destroy the component.\n     *\n     * @public\n     * @method destroy\n     * @param {Object} [options] - Options passed to `_emptyRegion` and `destroy`\n     * @memberOf Component\n     */\n    destroy: function(options){\n        this._emptyRegion(options);\n\n        this._shouldDestroy = true;\n\n        this._destroy(options);\n    }\n  });\n\n  var component = Component;\n\n  var previousToolkit = Marionette.Toolkit;\n\n  var Toolkit = Marionette.Toolkit = {};\n\n  Toolkit.noConflict = function() {\n    Marionette.Toolkit = previousToolkit;\n    return this;\n  };\n\n  Toolkit.VERSION = '0.4.0';\n\n  Toolkit.StateClass = state_class;\n\n  Toolkit.App = app;\n\n  Toolkit.Component = component;\n\n  var marionette_toolkit = Toolkit;\n\n  return marionette_toolkit;\n\n}));\n"],"sourceRoot":"/source/"}